{"version":3,"sources":["webpack:///./demo-src/App.vue?5dd6","webpack:///./src/index.vue?84a8","webpack:///src/index.vue","webpack:///./src/index.vue?5fc8","webpack:///./src/index.vue","webpack:///./demo-src/App.vue?5733","webpack:///demo-src/App.vue","webpack:///./demo-src/App.vue","webpack:///./demo-src/index.js","webpack:///./src/index.vue?f5a3","webpack:///./demo-src/App.vue?53a6"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","click","reset","_v","items","length","attrs","direction","auto","head","id","next","prev","handler","loadPrevPage","_e","_l","item","key","style","background","color","join","_s","loadNextPage","_withStripped","onClick","_t","state","error","name","props","Function","type","String","default","data","watch","b","addListeners","check","removeListeners","setState","autoScroll","getScrollY","inViewport","restorePosition","scrollContainer","includes","window","getComputedStyle","$el","parentElement","overflowY","y","scrollY","child1","createChild","document","body","insertBefore","firstChild","scrollTo","child2","result","removeChild","el","createElement","height","autoScrollTest","top","getBoundingClientRect","scrollBy","methods","load","savePosition","e","lastHead","spacing","querySelector","bottom","console","log","getScrollHeight","getClientHeight","innerHeight","clientHeight","documentElement","scrollHeight","scrollTop","timer","setTimeout","isNear","h","screen","rect","contRect","addEventListener","removeEventListener","component","options","__file","components","Vue","App","$mount"],"mappings":"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","file":"51ea783d0cfcd83344f4.js","sourcesContent":["var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"main\",\n    [\n      _c(\"button\", { staticClass: \"btn-reset\", on: { click: _vm.reset } }, [\n        _vm._v(\"reset\")\n      ]),\n      _vm._v(\" \"),\n      _vm.items.length\n        ? _c(\"InfiniteScroll\", {\n            attrs: {\n              direction: \"up\",\n              auto: \"in-viewport\",\n              head: _vm.items.length ? _vm.items[0].id : null,\n              next: _vm.prev,\n              handler: _vm.loadPrevPage\n            }\n          })\n        : _vm._e(),\n      _vm._v(\" \"),\n      _c(\n        \"ul\",\n        _vm._l(_vm.items, function(item) {\n          return _c(\n            \"li\",\n            {\n              key: item.id,\n              style: { background: \"rgb(\" + item.color.join() + \")\" },\n              attrs: { \"data-inf-id\": item.id }\n            },\n            [_vm._v(\"\\n      \" + _vm._s(item.id) + \"\\n    \")]\n          )\n        }),\n        0\n      ),\n      _vm._v(\" \"),\n      _c(\"InfiniteScroll\", {\n        attrs: {\n          head: _vm.items.length ? _vm.items[_vm.items.length - 1].id : null,\n          next: _vm.next,\n          handler: _vm.loadNextPage\n        }\n      })\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"infinite-scroll\", on: { click: _vm.onClick } },\n    [\n      _vm._t(\n        \"default\",\n        [\n          _vm.state === \"loading\"\n            ? [_vm._v(\"\\n      Loading...\\n    \")]\n            : _vm.state === \"empty\"\n            ? [_vm._v(\"\\n      Empty\\n    \")]\n            : _vm.state === \"end\"\n            ? [_vm._v(\"\\n      End\\n    \")]\n            : _vm.state === \"error\"\n            ? [_vm._v(\"\\n      An error occurred. Click to retry.\\n    \")]\n            : _vm.state === \"standby\" && _vm.auto !== \"in-advance\"\n            ? [\n                _vm._v(\n                  \"\\n      \" +\n                    _vm._s(\n                      _vm.auto\n                        ? \"Scroll \" + _vm.direction + \" to load more\"\n                        : \"Click to load more\"\n                    ) +\n                    \"\\n    \"\n                )\n              ]\n            : _vm._e()\n        ],\n        {\n          state: _vm.state,\n          error: _vm.error,\n          auto: _vm.auto,\n          direction: _vm.direction\n        }\n      )\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"infinite-scroll\" @click=\"onClick\">\n    <slot :state=\"state\" :error=\"error\" :auto=\"auto\" :direction=\"direction\">\n      <template v-if=\"state === 'loading'\">\n        Loading...\n      </template>\n\n      <template v-else-if=\"state === 'empty'\">\n        Empty\n      </template>\n\n      <template v-else-if=\"state === 'end'\">\n        End\n      </template>\n\n      <template v-else-if=\"state === 'error'\">\n        An error occurred. Click to retry.\n      </template>\n\n      <template v-else-if=\"state === 'standby' && auto !== 'in-advance'\">\n        {{ auto ? `Scroll ${direction} to load more` : 'Click to load more' }}\n      </template>\n    </slot>\n  </div>\n</template>\n\n<script>\nfunction autoScrollTest() {\n  const y = window.scrollY\n  const child1 = createChild()\n  document.body.insertBefore(child1, document.body.firstChild)\n  window.scrollTo(0, 1)\n  const child2 = createChild()\n  document.body.insertBefore(child2, child1)\n  const result = window.scrollY !== 1\n  document.body.removeChild(child1)\n  document.body.removeChild(child2)\n  window.scrollTo(0, y)\n  return result\n\n  function createChild() {\n    const el = document.createElement('div')\n    el.style.height = '200vh'\n    return el\n  }\n}\n\nexport default {\n  name: 'InfiniteScroll',\n\n  props: {\n    handler: Function,\n    head: {},\n    next: {},\n\n    direction: {\n      type: String,\n      default: 'down'\n    },\n\n    auto: {\n      default: 'in-advance' // in-advance, in-viewport\n    }\n  },\n\n  data: () => ({\n    state: 'standby',\n    error: {}\n  }),\n\n  watch: {\n    auto(b) {\n      if (b) {\n        this.addListeners()\n        this.check()\n      } else {\n        this.removeListeners()\n      }\n    },\n\n    head: 'setState',\n\n    next() {\n      this.setState()\n\n      if (this.direction === 'up' && this.head != null &&\n        (!this.autoScroll || this.getScrollY() === 0 || this.auto === 'in-viewport' && this.inViewport())\n      ) {\n        this.restorePosition()\n      }\n\n      if (this.auto === 'in-advance') {\n        this.check()\n      }\n    }\n  },\n\n  created() {\n    this.setState()\n  },\n\n  mounted() {\n    this.scrollContainer = ['scroll', 'auto'].includes(window.getComputedStyle(this.$el.parentElement).overflowY)\n      ? this.$el.parentElement\n      : window\n\n    if (this.direction === 'up') {\n      this.autoScroll = this.scrollContainer === window ? autoScrollTest() : false\n    }\n\n    if (this.auto) {\n      this.addListeners()\n\n      if (this.auto === 'in-advance') {\n        this.check()\n      } else if (this.direction === 'up' && this.inViewport()) {\n        let y\n        const top = this.$el.getBoundingClientRect().top\n\n        if (this.scrollContainer === window) {\n          y = top + 1\n        } else {\n          y = top - this.scrollContainer.getBoundingClientRect().top + 1\n        }\n\n        this.scrollContainer.scrollBy(0, y)\n      }\n    }\n  },\n\n  destroyed() {\n    this.removeListeners()\n  },\n\n  methods: {\n    setState() {\n      this.state = this.next === '' || this.next === 0\n        ? this.head == null\n          ? 'empty'\n          : 'end'\n        : 'standby'\n    },\n\n    onClick() {\n      if (this.state === 'standby' || this.state === 'error') {\n        this.load()\n      }\n    },\n\n    async load() {\n      this.state = 'loading'\n      this.error = null\n\n      if (this.direction === 'up') {\n        this.savePosition()\n      }\n\n      try {\n        await this.handler()\n      } catch (e) {\n        this.state = 'error'\n        this.error = e\n      }\n    },\n\n    savePosition() {\n      this.lastHead = this.head\n\n      this.spacing = this.head != null\n        ? document.querySelector(`[data-inf-id=\"${this.head}\"]`).getBoundingClientRect().top -\n          this.$el.getBoundingClientRect().bottom\n        : 0\n    },\n\n    restorePosition() {\n      console.log('restorePosition')\n\n      const y = this.lastHead != null\n        ? this.getScrollY() +\n          document.querySelector(`[data-inf-id=\"${this.lastHead}\"]`).getBoundingClientRect().top -\n          this.$el.getBoundingClientRect().bottom - this.spacing\n        : this.getScrollHeight() - this.getClientHeight()\n\n      this.scrollContainer.scrollTo(0, y)\n    },\n\n    getClientHeight() {\n      return this.scrollContainer === window\n        ? window.innerHeight\n        : this.scrollContainer.clientHeight\n    },\n\n    getScrollHeight() {\n      return this.scrollContainer === window\n        ? document.documentElement.scrollHeight\n        : this.scrollContainer.scrollHeight\n    },\n\n    getScrollY() {\n      return this.scrollContainer === window\n        ? window.scrollY\n        : this.scrollContainer.scrollTop\n    },\n\n    check() {\n      if (this.state === 'standby' && !this.timer) {\n        this.timer = setTimeout(() => {\n          this.timer = null\n\n          if (this.auto === 'in-advance' && this.isNear() || this.auto === 'in-viewport' && this.inViewport()) {\n            this.load()\n          }\n        })\n      }\n    },\n\n    isNear() {\n      const y = this.getScrollY()\n      const h = this.getScrollHeight()\n\n      return this.direction === 'down' && h - y < window.screen.height * 2 ||\n        this.direction === 'up' && y < window.screen.height\n    },\n\n    inViewport() {\n      const rect = this.$el.getBoundingClientRect()\n\n      if (this.scrollContainer === window) {\n        if (rect.top >= 0 && rect.bottom <= window.innerHeight) {\n          return true\n        }\n      } else {\n        const contRect = this.scrollContainer.getBoundingClientRect()\n\n        if (rect.top >= contRect.top && rect.bottom <= contRect.bottom) {\n          return true\n        }\n      }\n\n      return false\n    },\n\n    addListeners() {\n      this.scrollContainer.addEventListener('scroll', this.check)\n      window.addEventListener('resize', this.check)\n    },\n\n    removeListeners() {\n      this.scrollContainer.removeEventListener('scroll', this.check)\n      window.removeEventListener('resize', this.check)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.infinite-scroll {\n  font-size: 0.8em;\n  color: #666;\n  margin: 1em 0;\n  height: 2em;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n</style>\n","import mod from \"-!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2964abc9&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=2964abc9&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2964abc9\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/jfm/projects/vue-infinite-scroll/node_modules/.pnpm/vue-hot-reload-api@2.3.4/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('2964abc9')) {\n      api.createRecord('2964abc9', component.options)\n    } else {\n      api.reload('2964abc9', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=2964abc9&scoped=true&\", function () {\n      api.rerender('2964abc9', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/index.vue\"\nexport default component.exports","import mod from \"-!../node_modules/.pnpm/babel-loader@8.1.0_7e7526731d462686de4308c8ba1cfd85/node_modules/babel-loader/lib/index.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/.pnpm/babel-loader@8.1.0_7e7526731d462686de4308c8ba1cfd85/node_modules/babel-loader/lib/index.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","<template>\n  <main>\n    <button class=\"btn-reset\" @click=\"reset\">reset</button>\n\n    <!-- infinite scroll up -->\n    <InfiniteScroll\n      v-if=\"items.length\"\n      direction=\"up\"\n      auto=\"in-viewport\"\n      :head=\"items.length ? items[0].id : null\"\n      :next=\"prev\"\n      :handler=\"loadPrevPage\"\n    />\n\n    <ul>\n      <!--\n        If you use upward infinite scroll, `data-inf-id` should be set.\n        If you use downward infinite scroll, it is not needed.\n      -->\n      <li\n        v-for=\"item in items\"\n        :key=\"item.id\"\n        :data-inf-id=\"item.id\"\n        :style=\"{ background: `rgb(${item.color.join()})` }\"\n      >\n        {{ item.id }}\n      </li>\n    </ul>\n\n    <!-- infinite scroll down -->\n    <InfiniteScroll\n      :head=\"items.length ? items[items.length - 1].id : null\"\n      :next=\"next\"\n      :handler=\"loadNextPage\"\n    />\n  </main>\n</template>\n\n<script>\nimport hslRgb from 'hsl-rgb'\nimport InfiniteScroll from '../src'\n\nconst limit = 10\n\nexport default {\n  components: { InfiniteScroll },\n\n  data: () => ({\n    items: [],\n    prev: 4,\n    next: 5\n  }),\n\n  methods: {\n    async loadNextPage() {\n      console.log(Date.now(), 'loadNextPage')\n      const page = this.next\n      const { items, totalCount } = await this.getMockData({ limit, page })\n\n      if (page === this.next) {\n        this.items = this.items.concat(items)\n        this.next = totalCount / limit > page ? page + 1 : 0\n        console.log('next:', this.next)\n      }\n    },\n\n    async loadPrevPage() {\n      console.log(Date.now(), 'loadPrevPage')\n      const page = this.prev\n      const { items } = await this.getMockData({ limit, page })\n\n      if (page === this.prev) {\n        this.items = items.concat(this.items)\n        this.prev = page - 1\n        console.log('prev:', this.prev)\n      }\n    },\n\n    async getMockData({ limit = 10, page = 1 } = {}) {\n      console.log('page:', page)\n      await new Promise(resolve => setTimeout(resolve, Math.random() * 2000))\n\n      // if (Math.random() > 0.7) {\n      //   throw new Error('server error')\n      // }\n\n      const totalCount = 100\n      const start = (page - 1) * limit\n      const end = Math.min(start + limit, totalCount)\n      const items = []\n\n      for (let i = start; i < end; i++) {\n        const color = hslRgb(360 / (totalCount - 1) * i, 0.67, 0.67)\n        items.push({ id: i, color })\n      }\n\n      return {\n        items,\n        totalCount\n      }\n    },\n\n    reset() {\n      this.items = []\n      this.prev = 4\n      this.next = 5\n    }\n  }\n}\n</script>\n\n<style scoped>\nmain {\n  max-width: 600px;\n  margin: 0 auto;\n}\n\nul {\n  padding: 0;\n}\n\nli {\n  margin: 10px;\n  list-style: none;\n  height: 128px;\n  border-radius: 4px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 18px\n}\n\n.btn-reset {\n  position: fixed;\n  right: 0;\n  top: 0;\n}\n</style>\n","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=3783d5fa&scoped=true&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=3783d5fa&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3783d5fa\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/jfm/projects/vue-infinite-scroll/node_modules/.pnpm/vue-hot-reload-api@2.3.4/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('3783d5fa')) {\n      api.createRecord('3783d5fa', component.options)\n    } else {\n      api.reload('3783d5fa', component.options)\n    }\n    module.hot.accept(\"./App.vue?vue&type=template&id=3783d5fa&scoped=true&\", function () {\n      api.rerender('3783d5fa', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"demo-src/App.vue\"\nexport default component.exports","import Vue from 'vue'\nimport App from './App'\n\nnew Vue(App).$mount('#app')\n","import mod from \"-!../node_modules/.pnpm/mini-css-extract-plugin@0.10.0_webpack@4.44.1/node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/.pnpm/css-loader@4.2.1_webpack@4.44.1/node_modules/css-loader/dist/cjs.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2964abc9&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/.pnpm/mini-css-extract-plugin@0.10.0_webpack@4.44.1/node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/.pnpm/css-loader@4.2.1_webpack@4.44.1/node_modules/css-loader/dist/cjs.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2964abc9&scoped=true&lang=css&\"","import mod from \"-!../node_modules/.pnpm/mini-css-extract-plugin@0.10.0_webpack@4.44.1/node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/.pnpm/css-loader@4.2.1_webpack@4.44.1/node_modules/css-loader/dist/cjs.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&id=3783d5fa&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/.pnpm/mini-css-extract-plugin@0.10.0_webpack@4.44.1/node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/.pnpm/css-loader@4.2.1_webpack@4.44.1/node_modules/css-loader/dist/cjs.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js!../node_modules/.pnpm/vue-loader@15.9.3_a9ab00a2eb7c654a18ca183dffd6ce90/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&id=3783d5fa&scoped=true&lang=css&\""],"sourceRoot":""}